apiVersion: kfdef.apps.kubeflow.org/v1
kind: KfDef
metadata:
  namespace: kubeflow
spec:
  applications:
  - kustomizeConfig:
      repoRef:
        name: manifests
        path: common/kubeflow-namespace/base
    name: kubeflow-namespace
  - kustomizeConfig:
      repoRef:
        name: manifests
        path: common/kubeflow-roles/base
    name: kubeflow-roles
  - kustomizeConfig:
      repoRef:
        name: manifests
        path: distributions/stacks/aws/application/istio-1-9-1-stack
    name: istio-stack
  - kustomizeConfig:
      repoRef:
        name: manifests
        path: common/cert-manager/cert-manager-kube-system-resources/base
    name: cert-manager-kube-system-resources
  - kustomizeConfig:
      repoRef:
        name: manifests
        path: contrib/application/v3
    name: application
  - kustomizeConfig:
      repoRef:
        name: manifests
        path: common/cert-manager/cert-manager-crds/base
    name: cert-manager-crds
  - kustomizeConfig:
      repoRef:
        name: manifests
        path: common/cert-manager/cert-manager/overlays/self-signed
    name: cert-manager
  - kustomizeConfig:
      repoRef:
        name: manifests
        path: distributions/stacks/aws/application/aws-lbc-controller
    name: aws-lbc-controller
  - kustomizeConfig:
      repoRef:
        name: manifests
        path: distributions/stacks/aws/application/istio-ingress-cognito
    name: istio-ingress
  # - kustomizeConfig:
  #     repoRef:
  #       name: manifests
  #       path: distributions/stacks/aws/application/aws-istio-auth-envoy-filter
  #   name: aws-istio-auth-envoy-filter
  - kustomizeConfig:
      repoRef:
        name: manifests
        path: common/knative/knative-serving-crds/base
    name: knative-serving-crds
  - kustomizeConfig:
      repoRef:
        name: manifests
        path: common/knative/knative-serving-install/base
    name: knative-serving-install
  - kustomizeConfig:
      repoRef:
        name: manifests
        path: common/knative/knative-eventing-crds/base
    name: knative-eventing-crds
  - kustomizeConfig:
      repoRef:
        name: manifests
        path: common/knative/knative-eventing-install/base
    name: knative-eventing-install
  - kustomizeConfig:
      repoRef:
        name: manifests
        path: common/istio-1-9-0/kubeflow-istio-resources/base
    name: kubeflow-apps
  - kustomizeConfig:
      repoRef:
        name: manifests
        path: apps/pipeline/upstream/env/platform-agnostic-multi-user
    name: kubeflow-pipelines
  - kustomizeConfig:
      repoRef:
        name: manifests
        path: apps/kfserving/upstream/overlays/kubeflow
    name: kfserving
  - kustomizeConfig:
      repoRef:
        name: manifests
        path: apps/katib/upstream/installs/katib-with-kubeflow
    name: katib
  - kustomizeConfig:
      repoRef:
        name: manifests
        path: apps/centraldashboard/upstream/overlays/istio
    name: central-dashboard
  - kustomizeConfig:
      repoRef:
        name: manifests
        path: distributions/stacks/aws/application/notebooks
    name: notebooks
  - kustomizeConfig:
      repoRef:
        name: manifests
        path: apps/profiles/upstream/overlays/kubeflow
    name: profiles
  - kustomizeConfig:
      repoRef:
        name: manifests
        path: apps/volumes-web-app/upstream/overlays/istio
    name: volumes-web-app
  - kustomizeConfig:
      repoRef:
        name: manifests
        path: distributions/stacks/aws/application/tensorboard
    name: tensorboard
  - kustomizeConfig:
      repoRef:
        name: manifests
        path: apps/tf-training/upstream/overlays/kubeflow
    name: tfjob-operator
  - kustomizeConfig:
      repoRef:
        name: manifests
        path: apps/pytorch-job/upstream/overlays/kubeflow
    name: pytorch-operator
  - kustomizeConfig:
      repoRef:
        name: manifests
        path: apps/mpi-job/upstream/overlays/kubeflow
    name: mpi-operator
  - kustomizeConfig:
      repoRef:
        name: manifests
        path: apps/mxnet-job/upstream/overlays/kubeflow
    name: mxnet-operator
  - kustomizeConfig:
      repoRef:
        name: manifests
        path: apps/xgboost-job/upstream/overlays/kubeflow
    name: xgboost-operator
  - kustomizeConfig:
      repoRef:
        name: manifests
        path: common/user-namespace/base
    name: user-namespace
  plugins:
  - kind: KfAwsPlugin
    metadata:
      creationTimestamp: null
      name: aws
    spec:
      auth:
        cognito:
          certArn: arn:aws:acm:us-west-2:xxxxx:certificate/xxxxxxxxxxxxx-xxxx
          cognitoAppClientId: xxxxxbxxxxxx
          cognitoUserPoolArn: arn:aws:cognito-idp:us-west-2:xxxxx:userpool/us-west-2_xxxxxx
          cognitoUserPoolDomain: your-user-pool
      enablePodIamPolicy: true
      region: us-west-2
  repos:
  - name: manifests
    uri: https://github.com/awslabs/kubeflow-manifests/archive/v1.3-cognito.tar.gz
  version: v1.3-cognito
